(()=>{"use strict";const e=window.wc.blocksCheckout,t=window.React,s=window.wp.element,i=window.wp.components,n=window.wp.primitives,a=(0,t.createElement)(n.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"-2 -2 24 24"},(0,t.createElement)(n.Path,{d:"M10 2c4.42 0 8 3.58 8 8s-3.58 8-8 8-8-3.58-8-8 3.58-8 8-8zm1.13 9.38l.35-6.46H8.52l.35 6.46h2.26zm-.09 3.36c.24-.23.37-.55.37-.96 0-.42-.12-.74-.36-.97s-.59-.35-1.06-.35-.82.12-1.07.35-.37.55-.37.97c0 .41.13.73.38.96.26.23.61.34 1.06.34s.8-.11 1.05-.34z"})),l=window.wp.data,o=window.lodash,r=()=>wcSettings&&wcSettings["omnivalt-blocks_data"]?wcSettings["omnivalt-blocks_data"]:[],c=e=>!!e.startsWith("omnivalt"),m=e=>{for(let[t,s]of Object.entries(r().methods))if(e==s)return d("Detected Omniva method",s),!0;return!1},h=r().debug,_="OMNIVA BLOCKS DEBUG:",d=(...e)=>{h&&console.log(_,...e)},p=(e,t)=>{h&&(0,s.useEffect)((()=>{console.log(_,'Changed state "'+e+'" value to:',t)}),[t])},u=window.wp.i18n,v=wcSettings["omnivalt-blocks_data"].txt,f=((0,u.__)("Block options","omnivalt"),(0,u.__)("Parcel terminal","omnivalt"),(0,u.__)("Select parcel terminal","omnivalt"),(0,u.__)("Please select parcel terminal","omnivalt"),(0,u.__)("You can choose the parcel terminal on the Checkout page","omnivalt"),(0,u.__)("Loading select field...","omnivalt"),(0,u.__)("Post office","omnivalt"),(0,u.__)("Select post office","omnivalt"),(0,u.__)("Please select post office","omnivalt"),(0,u.__)("You can choose the post office on the Checkout page","omnivalt"),(0,u.__)("Omniva","omnivalt"),(0,u.__)("Matkahuolto","omnivalt"),(0,u.__)("Invalid format","omnivalt"),(0,u.__)("The phone format specified in the Shipping address is not valid for this shipping method","omnivalt"),(0,u.__)("post offices","omnivalt"),(0,u.__)("parcel terminals","omnivalt"),(0,u.__)("Post offices list","omnivalt"),(0,u.__)("Parcel terminals list","omnivalt"),(0,u.__)("Select post office","omnivalt"),(0,u.__)("Select terminal","omnivalt"),(0,u.__)("Enter postcode","omnivalt"),(0,u.__)("Search","omnivalt"),(0,u.__)("Select","omnivalt"),(0,u.__)("Select in map","omnivalt"),(0,u.__)("Use my location","omnivalt"),(0,u.__)("Distance calculated from this point","omnivalt"),(0,u.__)("Place not found","omnivalt"),(0,u.__)("There were no cities found for your search term","omnivalt"),(0,u.__)("Geolocation is not supported","omnivalt"),(0,u.__)("Place not found","omnivalt"),(0,u.__)("Value is too short","omnivalt"),(0,u.__)("Select terminal","omnivalt"),(0,u.__)("parcel terminals","omnivalt"),(0,u.__)("Parcel terminals addresses","omnivalt"),(0,u.__)("Select post office","omnivalt"),(0,u.__)("post offices","omnivalt"),(0,u.__)("Post offices addresses","omnivalt"),(0,u.__)("Enter postcode/address","omnivalt"),(0,u.__)("Show in map","omnivalt"),(0,u.__)("Show more","omnivalt"),e=>{let t="";let s=0;for(;s<e;)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random())),s+=1;return t}),g=(e,t=0)=>(t||(t=5),{value:e,token:f(t)}),y=e=>{for(const t in e)if(Object.hasOwn(e,t))return!1;return!0},w=async e=>{let t=null;try{let s=await fetch(e);t=await s.json()}catch(e){console.error("OMNIVA UTILS:",e)}return t},b=(e,t)=>{e.value=t;const s=new Event("change",{bubbles:!0});e.dispatchEvent(s)},E=()=>({lib:null,elements:{},translations:{},params:{},variables:{allow_close_modal:!0},load_data:function(e){this.elements={org_field:this.set_param(e,"org_field",null),map_container:this.set_param(e,"map_container",null)},this.params={provider:this.set_param(e,"provider","omniva"),terminals_type:this.set_param(e,"terminals_type","terminal"),selected_terminal:this.set_param(e,"selected_terminal",""),autoselect:this.set_param(e,"autoselect",!0),icons_url:this.set_param(e,"icons_url",`${r().plugin_url}assets/img/terminal-mapping/`),country:this.set_param(e,"country","LT"),map_icon:this.set_param(e,"map_icon","omnivalt_icon.png")};const t="post"==this.params.terminals_type?v.map.modal_title_post:v.map.modal_title_terminal,s=this.params.provider in v.providers?v.providers[this.params.provider]:v.providers.omniva;this.translations={modal_header:s+" "+t,terminal_list_header:"post"==this.params.terminals_type?v.map.modal_search_title_post:v.map.modal_search_title_terminal,select_pickup_point:"post"==this.params.terminals_type?v.map.select_post:v.map.select_terminal,seach_header:v.map.search_placeholder,search_btn:v.map.search_button,select_btn:v.map.select_button,modal_open_btn:v.map.modal_open_button,geolocation_btn:v.map.use_my_location,your_position:v.map.my_position,nothing_found:v.map.not_found,no_cities_found:v.map.no_cities_found,geolocation_not_supported:v.map.geo_not_supported}},set_param:function(e,t,s=null){return t in e?e[t]:s},init:function(e){this.elements.map_container?(this.lib=new TerminalMappingOmnivalt,this.lib.setImagesPath(this.params.icons_url),this.lib.setTranslation(this.translations),this.lib.dom.setContainerParent(this.elements.map_container),this.lib.setParseMapTooltip(((e,t)=>{let s=e.address+" ["+e.id+"]";return e.comment&&(s+="<br/><i>"+e.comment+"</i>"),s})),this.build_actions(this),this.lib.init({country_code:this.params.country,identifier:"omnivalt",isModal:!0,modalParent:this.elements.map_container,hideContainer:!0,hideSelectBtn:!0,cssThemeRule:"tmjs-default-theme",customTileServerUrl:"https://maps.omnivasiunta.lt/tile/{z}/{x}/{y}.png",customTileAttribution:'&copy; <a href="https://www.omniva.lt">Omniva</a> | Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',terminalList:e})):this.error("Failed to get a container for the map")},build_actions:function(e){this.lib.sub("tmjs-ready",(function(t){e.lib.map.createIcon("omnivalt_icon",e.params.icons_url+e.params.map_icon),e.lib.map.refreshMarkerIcons();let s=t.map.getLocationById(e.params.selected_terminal);void 0!==s&&null!=s&&(e.lib.dom.setActiveTerminal(s),e.lib.publish("terminal-selected",s))})),this.lib.sub("search-result",(function(t){e.activate_autoselect()})),this.lib.sub("terminal-selected",(function(t){b(e.elements.org_field,t.id),e.lib.dom.setActiveTerminal(t.id),e.variables.allow_close_modal&&e.lib.publish("close-map-modal"),e.variables.allow_close_modal=!0}))},set_search_value:function(e){""!=(e=e.trim())&&this.lib.map&&(this.lib.dom.searchNearest(e),this.lib.dom.UI.modal.querySelector(".tmjs-search-input").value=e)},activate_autoselect:function(){this.params.autoselect&&""==this.params.selected_terminal&&this.lib&&"map"in this.lib&&this.lib.map&&"locations"in this.lib.map&&this.lib.map.locations.length&&(this.variables.allow_close_modal=!1,this.lib.dom.setActiveTerminal(this.lib.map.locations[0].id),this.lib.publish("terminal-selected",this.lib.map.locations[0]))},error:function(e){console.error("OMNIVA MAP:",e)}}),S=()=>({map:null,selected:{},terminals:[],elements:{},params:{},translations:{},loaded:!1,load_data:function(e){this.elements={org_field:this.set_param(e,"org_field",null),custom_container:this.set_param(e,"custom_container",null),this_dropdown:null,this_list:null,this_container:null,this_inner_container:null,this_loader:null,this_search:null,this_search_msg:null,this_show_more:null},this.params={provider:this.set_param(e,"provider","omniva"),terminals_type:this.set_param(e,"terminals_type","terminal"),country:this.set_param(e,"country","LT"),max_show:this.set_param(e,"max_show",8),active_timeout:null,autoselect:this.set_param(e,"autoselect",!0),selected_terminal:this.set_param(e,"selected_terminal","")},this.params.provider in v.providers?v.providers[this.params.provider]:v.providers.omniva,this.translations={not_found:v.select.not_found,too_short:v.select.search_too_short,select_terminal:"post"==this.params.terminals_type?v.select.post_select:v.select.terminal_select,enter_address:v.select.enter_address,show_more:v.select.show_more}},set_param:function(e,t,s=null){return t in e?e[t]:s},init:function(){if(y(this.elements))return void this.error("Load data is required before initialization");if(!this.elements.custom_container)return void this.error("Failed to get a container for the custom field");this.elements.org_field.value&&this.set_selected();let e,t=null;this.elements.this_container=document.createElement("div"),this.elements.this_container.classList.add("omnivalt-terminals-list"),this.elements.this_dropdown=document.createElement("div"),this.elements.this_dropdown.classList.add("dropdown"),this.elements.this_dropdown.innerHTML=this.translations.select_terminal,this.update_element_dropdown(),this.elements.this_search=document.createElement("input"),this.elements.this_search.type="text",this.elements.this_search.classList.add("search-input"),this.elements.this_search.placeholder=this.translations.enter_address,this.elements.this_search_msg=document.createElement("span"),this.elements.this_search_msg.classList.add("search-msg"),this.show_element_search_msg(!1),this.elements.this_loader=document.createElement("div"),this.elements.this_loader.classList.add("omnivalt-loader"),this.show_element_loader(!1),this.elements.this_list=document.createElement("ul"),this.elements.this_show_more=document.createElement("div"),this.elements.this_show_more.classList.add("show-more"),e=document.createElement("a"),t=document.createTextNode(this.translations.show_more),e.appendChild(t),e.href="#",this.elements.this_show_more.appendChild(e),this.elements.this_inner_container=document.createElement("div"),this.elements.this_inner_container.classList.add("inner-container"),this.show_element_inner_container(!1),this.elements.this_inner_container.append(this.elements.this_search,this.elements.this_search_msg,this.elements.this_loader,this.elements.this_list,this.elements.this_show_more),this.elements.this_container.append(this.elements.this_dropdown,this.elements.this_inner_container),this.elements.custom_container.append(this.elements.this_container),this.reset_terminals(),this.refresh_element_list(),this.elements.this_show_more.addEventListener("click",(e=>{e.preventDefault(),this.show_element_all_options()})),this.elements.this_dropdown.addEventListener("click",(e=>{this.toggle_dropdown()})),this.elements.org_field.addEventListener("click",(e=>{this.set_selected(),this.update_element_dropdown(),this.elements.this_list.querySelector('li[data-id="'+this.elements.org_field.value+'"').classList.add("selected")})),this.elements.this_search.addEventListener("keyup",(()=>{this.show_element_search_msg(!1),this.show_element_loader(!0),clearTimeout(this.params.active_timeout),this.params.active_timeout=setTimeout((()=>{this.params.autoselect=!1,this.geo_suggest(this.elements.this_search.value)}),400)})),this.elements.this_search.addEventListener("keyup",(e=>{"13"==e.which&&e.preventDefault()})),document.addEventListener("mousedown",(e=>{this.elements.this_container!=e.target&&!this.elements.this_container.contains(e.target)&&this.elements.this_container.classList.contains("open")&&this.toggle_dropdown(!0)})),this.loaded=!0},set_terminals:function(e){for(let t=0;t<e.length;t++)e[t].distance=!1;this.terminals=e},set_selected:function(){this.selected={id:this.params.selected_terminal,text:this.elements.org_field.options[this.elements.org_field.selectedIndex].text,distance:!1}},set_search_value:function(e){this.elements.this_search.value=e.trim(),this.geo_suggest(this.elements.this_search.value)},activate_autoselect:function(){if(""==this.params.selected_terminal){let e=this.elements.this_list.querySelector("li:not(.city)");this.mark_element_list_selected(e)}},update_element_dropdown:function(){"text"in this.selected&&(this.elements.this_dropdown.innerHTML=this.selected.text)},show_element_loader:function(e=!1){this.elements.this_loader.style.display=e?"block":"none"},show_element_search_msg:function(e=!1){this.elements.this_search_msg.style.display=e?"block":"none"},show_element_inner_container:function(e=!1){this.elements.this_inner_container.style.display=e?"block":"none"},refresh_element_list:function(){let e,t,s,i,n=0,a=!1;this.clear_element_list();for(let l of this.terminals)e=document.createElement("li"),e.setAttribute("data-id",l.id),e.innerHTML=l.name,"distance"in l&&!1!==l.distance?(s=document.createElement("strong"),i=document.createTextNode(l.distance+"km"),s.appendChild(i),e.innerHTML+=" "+s.outerHTML,n++):this.elements.this_show_more.style.display="none","id"in this.selected&&this.selected.id==l.id&&e.classList.add("selected"),n>this.params.max_show&&(e.style.display="none"),a!=l.city&&(t=document.createElement("li"),t.classList.add("city"),t.innerHTML=l.city,n>this.params.max_show&&(t.style.display="none"),this.elements.this_list.append(t),a=l.city),this.elements.this_list.append(e);this.elements.this_list.querySelectorAll("li:not(.city)").forEach((e=>e.addEventListener("click",(()=>{this.mark_element_list_selected(e)}))))},clear_element_list:function(){for(;this.elements.this_list.firstChild;)this.elements.this_list.removeChild(this.elements.this_list.lastChild)},unmark_element_list_selected:function(){let e=this.elements.this_list.querySelector("li.selected");e&&e.classList.remove("selected")},mark_element_list_selected:function(e){this.unmark_element_list_selected();const t=e.getAttribute("data-id");e.classList.add("selected"),b(this.elements.org_field,t),this.params.selected_terminal=t,this.set_selected(),this.update_element_dropdown(),this.toggle_dropdown(!0)},toggle_dropdown:function(e=!1){this.elements.this_container.classList.contains("open")||e?(this.show_element_inner_container(!1),this.elements.this_container.classList.remove("open")):(this.show_element_inner_container(!0),this.elements.this_container.classList.add("open"))},show_element_all_options:function(){this.elements.this_list.querySelectorAll("li").forEach((e=>{e.style.display="",this.elements.this_show_more.style.display="none"}))},hide_element_all_options:function(){this.elements.this_list.querySelectorAll("li").forEach((e=>{e.style.display="none",this.elements.this_show_more.style.display=""}))},reset_terminals:function(){for(let e=0;e<this.terminals.length;e++)this.terminals[e].distance=!1;this.terminals.sort((function(e,t){return e.city.localeCompare(t.city)||t.name-e.name}))},geo_find_position:async function(e){if(""==e||e.length<3)return this.reset_terminals(),this.show_element_all_options(),this.refresh_element_list(),!1;let t="https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer/findAddressCandidates?singleLine="+e+"&sourceCountry="+this.params.country+"&category=&outFields=Postal&maxLocations=1&forStorage=false&f=pjson",s=await(async()=>await w(t))();if("candidates"in s&&s.candidates.length){let e=s.candidates[0];this.sort_list_by_distance(e.location.y,e.location.x),this.refresh_element_list(),this.elements.this_show_more.style.display="",this.params.autoselect&&this.activate_autoselect()}},geo_suggest:async function(e){if(""==e||e.length<3)return this.reset_terminals(),this.show_element_all_options(),this.refresh_element_list(),this.show_element_loader(!1),e.length&&(this.elements.this_search_msg.innerHTML=this.translations.too_short,this.show_element_search_msg(!0)),!1;let t="https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer/suggest?text="+e+"&f=pjson&sourceCountry="+this.params.country+"&maxSuggestions=1",s=await(async()=>await w(t))();"suggestions"in s&&s.suggestions.length?this.geo_find_position(s.suggestions[0].text):(this.elements.this_search_msg.innerHTML=this.translations.not_found,this.show_element_search_msg(!0),this.hide_element_all_options()),this.show_element_loader(!1)},sort_list_by_distance:function(e,t){let s;for(let i=0;i<this.terminals.length;i++)s=this.calculate_distance(e,t,this.terminals[i].coords.lat,this.terminals[i].coords.lng),this.terminals[i].distance=s.toFixed(2);this.terminals.sort(((e,t)=>{let s=e.distance,i=t.distance;return parseFloat(s)<parseFloat(i)?-1:parseFloat(s)>parseFloat(i)?1:0}))},calculate_distance:function(e,t,s,i){let n=this.to_radius(s-e),a=this.to_radius(i-t);e=this.to_radius(e),s=this.to_radius(s);let l=Math.sin(n/2)*Math.sin(n/2)+Math.sin(a/2)*Math.sin(a/2)*Math.cos(e)*Math.cos(s);return 2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))*6371},to_radius:e=>e*Math.PI/180,error:function(e){console.error("OMNIVA CUSTOM SELECT:",e)}}),k=JSON.parse('{"apiVersion":2,"name":"omnivalt/terminal-selection-checkout","version":"1.0.0","title":"Omniva terminal selection","category":"woocommerce","description":"Allow to add components for Omniva shipping method","parent":["woocommerce/checkout-shipping-methods-block"],"supports":{"html":false,"align":false,"multiple":false,"reusable":false},"attributes":{"lock":{"type":"object","default":{"remove":true,"move":true}},"text":{"type":"string","default":""}},"textdomain":"omnivalt"}');(0,e.registerCheckoutBlock)({metadata:k,component:({checkoutExtensionData:e,extensions:n})=>{const h="omnivalt_terminal",_="shipping_phone",{setExtensionData:u}=e,[f,w]=(0,s.useState)({country:"LT",postcode:""}),[b,k]=(0,s.useState)(null),[L,T]=(0,s.useState)([]),[M,x]=(0,s.useState)({}),[C,O]=(0,s.useState)([]),[A,I]=(0,s.useState)([{label:v.select_terminal,value:""}]),[P,N]=(0,s.useState)(g(!1)),[j,D]=(0,s.useState)({title:v.title_terminal,label:v.select_terminal,error:v.error_terminal}),[F,V]=(0,s.useState)(""),[q,H]=(0,s.useState)(""),[R,z]=(0,s.useState)({provider:"unknown",type:"unknown"}),[B,$]=(0,s.useState)(""),G=(0,s.useRef)(null),U=(0,s.useRef)(null),W=E(),Y=S();p("Block show",P),p("Terminals list",C),p("Destination",b),p("Map values",f),p("Selected terminal",F),p("Selected rate ID",q),p("Omniva dynamic data",M),(0,s.useCallback)((0,o.debounce)(((e,t,s)=>{u(e,t,s)}),1e3),[u]);const{setValidationErrors:J,clearValidationError:K}=(0,l.useDispatch)("wc/store/validation"),Q=(0,l.useSelect)((e=>e("wc/store/validation").getValidationError(h))),X=(0,l.useSelect)((e=>e("wc/store/validation").getValidationError(_))),Z=(0,l.useSelect)((e=>e("wc/store/cart").getCartData().shippingRates)),ee=(0,l.useSelect)((e=>{const t=e("wc/store/cart"),s=t.getCartData().billingAddress,i=t.getCartData().shippingAddress;return{phone:(i.phone&&""!==i.phone.trim()?i.phone:s.phone)||"",country:i.country}}));return(0,s.useEffect)((()=>{Z.length?T((e=>{if(!e.length)return[];let t=[];for(let s=0;s<e.length;s++)if(e[s].shipping_rates)for(let i=0;i<e[s].shipping_rates.length;i++)t.push(e[s].shipping_rates[i]);return t})(Z)):d("Empty param: shippingRates")}),[Z]),(0,s.useEffect)((()=>{N(g(!1)),d("Received "+L.length+" active rates:",L);for(let e=0;e<L.length;e++)L[e].rate_id&&L[e].selected&&(m(L[e].rate_id)&&L[e].selected&&N(g(!0)),H(L[e].rate_id))}),[L]),(0,s.useEffect)((()=>{k(((e,t=!0)=>{if(d("Getting destination..."),!e.length)return d("Failed to get destination because shipping rates is empty"),null;let s=[];for(let t=0;t<e.length;t++)e[t].destination&&s.push(e[t].destination);return s.length?t?(d("First destination",s[0]),s[0]):(d("Destinations",s),s):(d("Failed to get destination"),null)})(Z))}),[q]),(0,s.useEffect)((()=>{b&&""!=b.country.trim()?w({country:b.country,postcode:b.postcode}):w({country:"LT",postcode:""})}),[b]),(0,s.useEffect)((()=>{var e,t;q?b?(e=b.country,t=q,fetch(`${r().ajax_url}?action=omnivalt_get_dynamic_data&country=${e}&method=${t}`,{method:"GET",credentials:"same-origin",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).catch((e=>(console.error("Error fetching terminals:",e),[])))).then((e=>{if(e.data){const t=e.data;x(t)}else d("Failed to get dynamic Omniva data")})):d("Skipped retrieving dynamic Omniva data because the destination is still empty"):d("Skipped retrieving dynamic Omniva data because the value of the selected rate ID is not received")}),[b,q]),(0,s.useEffect)((()=>{if(y(M))return void d("Skipped getting Terminals because the Omniva dynamic data is empty");if(!1===M.terminals_type)return void d("The selected delivery method does not have a terminals");const e="terminals_type"in M?M.terminals_type:"omniva";var t,s;(t=f.country,s=e,fetch(`${r().ajax_url}?action=omnivalt_get_terminals&country=${t}&type=${s}`,{method:"GET",credentials:"same-origin",headers:{"Content-Type":"application/json"}}).then((e=>e.json())).catch((e=>(console.error("Error fetching terminals:",e),[])))).then((e=>{e.data?O(e.data):d("Failed to get terminals list")}))}),[M]),(0,s.useEffect)((()=>{const e={title:v.title_terminal,label:v.select_terminal,error:v.error_terminal};!y(M)&&"terminals_type"in M&&"post"==M.terminals_type&&(e.title=v.title_post,e.label=v.select_post,e.error=v.error_post),D(e)}),[M]),(0,s.useEffect)((()=>{if(!C.length)return void d("Skipped updating terminals block because the terminals list is empty");""!==F&&(d("Checking if the selected terminal is in the terminals list..."),((e,t,s)=>{for(let t=0;t<e.length;t++)if(e[t].id===s)return e[t];return null})(C,0,F)||(d("The specified terminal was not found in the list of terminals"),V(""))),d("Updating terminal selection options...");const e=[{label:j.label,value:""}];for(let t=0;t<C.length;t++)e.push({label:C[t].name,value:C[t].id});I(e)}),[C]),(0,s.useEffect)((()=>{if(U.current){""!==U.current.innerHTML&&(d("Removing previous custom field/map..."),(e=>{for(;e.firstChild;)e.removeChild(e.lastChild)})(U.current));let e=null,t=!0;"show_map"in r()&&(e=r().show_map,t=r().autoselect,z({provider:"provider"in M?M.provider:"unknown",type:"terminals_type"in M?M.terminals_type:"unknown"})),!0===e?(d("Initializing TMJS map..."),W.load_data({org_field:G.current,map_container:U.current,terminals_type:M.terminals_type,provider:M.provider,country:f.country,map_icon:M.map_icon,selected_terminal:F,autoselect:t}),W.init(C),W.set_search_value(f.postcode),W.activate_autoselect()):!1===e?(d("Initializing terminal select field..."),Y.load_data({org_field:G.current,custom_container:U.current,provider:M.provider,terminals_type:M.terminals_type,country:f.country,selected_terminal:F,autoselect_terminal:t}),Y.set_terminals(C),Y.init(),Y.set_search_value(f.postcode)):d("Failed to get map display param")}else d("Failed to get container for custom field/map")}),[A]),(0,s.useEffect)((()=>{K(_),c(q)&&(M.phone_regex&&""!==M.phone_regex.trim()?new RegExp(M.phone_regex).test(ee.phone)?d("Phone number is correct"):(d("Incorrect phone number. Regex: "+M.phone_regex),J({[_]:{message:v.errors.invalid_format,hidden:!1}})):d("Phone regex empty. Skipped validation."))}),[ee,M,q]),(0,s.useEffect)((()=>{Q&&(d("Clearing terminal validation error..."),K(h),$("")),m(q)&&(u("omnivalt","selected_terminal",F),""===F&&(d("Terminal not selected. Adding terminal validation error..."),J({[h]:{message:j.error,hidden:!1}}),$("error")))}),[u,F,q]),(0,s.useEffect)((()=>{u("omnivalt","selected_rate_id",q)}),[u,q]),c(q)?(0,t.createElement)("div",{className:"omnivalt-container"},(0,t.createElement)("div",{className:"omnivalt-general-errors"},X&&!X.hidden&&(0,t.createElement)("div",{className:"wc-block-components-validation-error omnivalt-phone-error"},(0,t.createElement)(i.Icon,{icon:a,size:20,className:"omnivalt-error-icon"}),(0,t.createElement)("span",null,v.errors.invalid_phone_format))),P.value&&(0,t.createElement)("div",{className:`omnivalt-terminal-select-container provider-${R.provider} type-${R.type} ${B}`},(0,t.createElement)("div",{id:"omnivalt-terminal-container-org",className:"omnivalt-org-select"},(0,t.createElement)(i.SelectControl,{id:"omnivalt-terminal-select-field",label:j.title,value:F,options:A,onChange:e=>V(e),ref:G}),Q?.hidden||""!==F?null:(0,t.createElement)("div",{className:"wc-block-components-validation-error omnivalt-terminal-error"},(0,t.createElement)(i.Icon,{icon:a,size:20,className:"omnivalt-error-icon"}),(0,t.createElement)("span",null,Q?.message))),(0,t.createElement)("div",{id:"omnivalt-terminal-container-map",className:"omnivalt-map-select",ref:U},(0,t.createElement)("div",{class:"omnivalt-loader"})))):null}})})();